# OddsMarket V1 ç¬¬ä¸€é˜¶æ®µå¼€å‘è®¡åˆ’

## ğŸ¯ æ€»ä½“æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Events    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Backend       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Blockchain    â”‚
â”‚   (React)       â”‚                 â”‚   (Node.js)     â”‚              â”‚   (BSC)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                   â”‚                                â”‚
        â”‚                                   â”‚                                â”‚
        â–¼                                   â–¼                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Socket.io      â”‚                 â”‚   Database      â”‚              â”‚  Smart Contract â”‚
â”‚  Client         â”‚                 â”‚   (SQLite)      â”‚              â”‚  Events         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **WebSocket å®æ—¶æ¨é€ç³»ç»Ÿ**
   - Socket.IO æœåŠ¡å™¨
   - æˆ¿é—´ç®¡ç†ï¼ˆæŒ‰å¸‚åœºåˆ†ç»„ï¼‰
   - äº‹ä»¶ç±»å‹ç®¡ç†
   - ç”¨æˆ·è®¢é˜…ç®¡ç†

2. **é“¾ä¸Šäº‹ä»¶ç›‘å¬ç³»ç»Ÿ**
   - åˆçº¦äº‹ä»¶ç›‘å¬å™¨
   - äº‹ä»¶è§£æå’ŒéªŒè¯
   - æ•°æ®åº“åŒæ­¥å™¨
   - é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

3. **äº¤æ˜“APIç³»ç»Ÿ**
   - RESTful API endpoints
   - Web3 é›†æˆ
   - äº¤æ˜“éªŒè¯å’Œå®‰å…¨
   - ç”¨æˆ·æƒé™ç®¡ç†

## ğŸ”§ æŠ€æœ¯é€‰å‹

### ä¾èµ–åŒ…å®‰è£…
```bash
# WebSocket
npm install socket.io

# äº‹ä»¶å¤„ç†
npm install eventemitter3

# å®šæ—¶ä»»åŠ¡
npm install node-cron

# å·¥å…·åº“
npm install lodash moment
```

### æ¶æ„æ¨¡å¼
- **äº‹ä»¶é©±åŠ¨æ¶æ„** (Event-Driven Architecture)
- **è§‚å¯Ÿè€…æ¨¡å¼** (Observer Pattern)
- **å‘å¸ƒè®¢é˜…æ¨¡å¼** (Pub/Sub Pattern)
- **è´£ä»»é“¾æ¨¡å¼** (Chain of Responsibility)

## ğŸ“Š æ•°æ®æµè®¾è®¡

### 1. WebSocket æ•°æ®æµ
```
åŒºå—é“¾äº‹ä»¶ â†’ äº‹ä»¶ç›‘å¬å™¨ â†’ æ•°æ®å¤„ç† â†’ WebSocketæ¨é€ â†’ å‰ç«¯æ›´æ–°
```

### 2. API æ•°æ®æµ
```
å‰ç«¯è¯·æ±‚ â†’ å‚æ•°éªŒè¯ â†’ åˆçº¦è°ƒç”¨ â†’ æ•°æ®åº“æ›´æ–° â†’ å“åº”è¿”å› â†’ WebSocketå¹¿æ’­
```

### 3. åŒæ­¥æ•°æ®æµ
```
åŒºå—é“¾çŠ¶æ€ â†’ å®šæ—¶åŒæ­¥ â†’ æ•°æ®åº“æ›´æ–° â†’ ä¸€è‡´æ€§æ£€æŸ¥ â†’ å¼‚å¸¸æŠ¥å‘Š
```

## ğŸª äº‹ä»¶ç±»å‹å®šä¹‰

### WebSocket äº‹ä»¶
```javascript
const SOCKET_EVENTS = {
  // è¿æ¥äº‹ä»¶
  CONNECTION: 'connection',
  DISCONNECT: 'disconnect',
  
  // è®¢é˜…äº‹ä»¶
  SUBSCRIBE_MARKET: 'subscribe:market',
  UNSUBSCRIBE_MARKET: 'unsubscribe:market',
  SUBSCRIBE_USER: 'subscribe:user',
  
  // å¸‚åœºäº‹ä»¶
  MARKET_CREATED: 'market:created',
  MARKET_UPDATED: 'market:updated',
  MARKET_CLOSED: 'market:closed',
  MARKET_RESOLVED: 'market:resolved',
  
  // ä»·æ ¼äº‹ä»¶
  PRICE_UPDATE: 'price:update',
  PRICE_BATCH_UPDATE: 'price:batch_update',
  
  // äº¤æ˜“äº‹ä»¶
  SHARES_BOUGHT: 'trade:shares_bought',
  SHARES_SOLD: 'trade:shares_sold',
  LIQUIDITY_ADDED: 'liquidity:added',
  LIQUIDITY_REMOVED: 'liquidity:removed',
  
  // ç”¨æˆ·äº‹ä»¶
  USER_POSITION_UPDATE: 'user:position_update',
  USER_BALANCE_UPDATE: 'user:balance_update'
};
```

### æ™ºèƒ½åˆçº¦äº‹ä»¶
```javascript
const CONTRACT_EVENTS = {
  MarketCreated: 'MarketCreated',
  SharesBought: 'SharesBought', 
  SharesSold: 'SharesSold',
  LiquidityAdded: 'LiquidityAdded',
  LiquidityRemoved: 'LiquidityRemoved',
  ResultProposed: 'ResultProposed',
  ResultFinalized: 'ResultFinalized',
  WinningsClaimed: 'WinningsClaimed'
};
```

## ğŸ” å®‰å…¨å’Œæ€§èƒ½è€ƒè™‘

### å®‰å…¨æªæ–½
1. **è¿æ¥è®¤è¯**: JWT token éªŒè¯
2. **é€Ÿç‡é™åˆ¶**: é˜²æ­¢ WebSocket æ»¥ç”¨
3. **æˆ¿é—´æƒé™**: ç”¨æˆ·åªèƒ½è®¢é˜…æœ‰æƒé™çš„å¸‚åœº
4. **æ•°æ®éªŒè¯**: æ‰€æœ‰é“¾ä¸Šæ•°æ®éƒ½éœ€éªŒè¯

### æ€§èƒ½ä¼˜åŒ–
1. **æ‰¹é‡æ›´æ–°**: ä»·æ ¼å˜åŒ–æ‰¹é‡æ¨é€
2. **æ™ºèƒ½è®¢é˜…**: æŒ‰éœ€è®¢é˜…ï¼Œå‡å°‘æ— ç”¨æ¨é€
3. **ç¼“å­˜ç­–ç•¥**: çƒ­ç‚¹æ•°æ®ç¼“å­˜
4. **è¿æ¥æ± **: æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–

## ğŸ“ å¼€å‘é‡Œç¨‹ç¢‘

### ç¬¬1å‘¨: WebSocket åŸºç¡€æ¡†æ¶
- [x] Socket.IO æœåŠ¡å™¨æ­å»º
- [x] åŸºç¡€äº‹ä»¶ç®¡ç†
- [x] æˆ¿é—´ç®¡ç†ç³»ç»Ÿ
- [x] è®¤è¯ä¸­é—´ä»¶

### ç¬¬2å‘¨: é“¾ä¸Šäº‹ä»¶ç›‘å¬
- [x] åˆçº¦äº‹ä»¶ç›‘å¬å™¨
- [x] äº‹ä»¶è§£æå’Œå¤„ç†
- [x] æ•°æ®åº“åŒæ­¥æœºåˆ¶
- [x] é”™è¯¯å¤„ç†å’Œé‡è¯•

### ç¬¬3å‘¨: äº¤æ˜“APIå®Œå–„
- [x] ä¹°å–ä»½é¢API
- [x] æµåŠ¨æ€§ç®¡ç†API
- [x] ç”¨æˆ·æŒä»“æŸ¥è¯¢
- [x] äº¤æ˜“å†å²è®°å½•

### ç¬¬4å‘¨: é›†æˆå’Œæµ‹è¯•
- [x] ç³»ç»Ÿé›†æˆæµ‹è¯•
- [x] æ€§èƒ½å‹åŠ›æµ‹è¯•
- [x] å‰ç«¯é›†æˆ
- [x] ç”Ÿäº§éƒ¨ç½²å‡†å¤‡

---

*Created by ä¸–ç•Œé¡¶çº§å…¨æ ˆå·¥ç¨‹å¸ˆ & OddsMarket é¡¹ç›®ä¸“å®¶é¡¾é—®*